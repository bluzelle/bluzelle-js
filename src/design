



let primaryConnection;
let secondaryConnection;




sendRead()
-> Send through primary connection
-> If redirect
    -> Replace secondary with redirect connection.

sendWrite()
-> If secondaryConnection exists, send secondaryConnection, else send primary
-> If redirect
    -> If redirect is to the primary connection, delete secondary connection.
    -> Replace secondary with redirect connection.



Abstractions I want.
~~~~~~~~~~~~~~~~~~~

Establishing a connection -> promise
Destroying a connection -> promise


API

// Connect is still the same.

connect();


// We cannot reconnect();




How do we remove connection?


How might we test the proper functioning of the primary and secondary connections?
Expose the primary/secondary in a module, and mock the redirects/disconnects.

Sample module exports:

- sendRead
- sendWrite
- connection
- primaryConnection {
    ws,
    host,
    url
}
- secondaryConnection {
    ws, 
    host, 
    url
}

- then API exports the actual functions